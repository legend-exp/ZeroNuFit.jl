<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · ZeroNuFit.jl</title><meta name="title" content="API · ZeroNuFit.jl"/><meta property="og:title" content="API · ZeroNuFit.jl"/><meta property="twitter:title" content="API · ZeroNuFit.jl"/><meta name="description" content="Documentation for ZeroNuFit.jl."/><meta property="og:description" content="Documentation for ZeroNuFit.jl."/><meta property="twitter:description" content="Documentation for ZeroNuFit.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ZeroNuFit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../likelihood/">Likelihood implementation</a></li><li><a class="tocitem" href="../installation/">First steps</a></li><li><a class="tocitem" href="../config/">Configuration file</a></li><li><a class="tocitem" href="../inputs/">Partitions and events</a></li><li><a class="tocitem" href="../toys/">Generating toys</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li class="is-active"><a class="tocitem" href>API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/legend-exp/ZeroNuFit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><ul><li><a href="#ZeroNuFit.Analysis.retrieve_real_fit_results"><code>ZeroNuFit.Analysis.retrieve_real_fit_results</code></a></li><li><a href="#ZeroNuFit.Analysis.run_analysis"><code>ZeroNuFit.Analysis.run_analysis</code></a></li><li><a href="#ZeroNuFit.Analysis.save_outputs"><code>ZeroNuFit.Analysis.save_outputs</code></a></li><li><a href="#ZeroNuFit.Likelihood.build_likelihood_looping_partitions"><code>ZeroNuFit.Likelihood.build_likelihood_looping_partitions</code></a></li><li><a href="#ZeroNuFit.Likelihood.build_likelihood_per_partition"><code>ZeroNuFit.Likelihood.build_likelihood_per_partition</code></a></li><li><a href="#ZeroNuFit.Likelihood.build_likelihood_zero_obs_evts"><code>ZeroNuFit.Likelihood.build_likelihood_zero_obs_evts</code></a></li><li><a href="#ZeroNuFit.Likelihood.build_prior"><code>ZeroNuFit.Likelihood.build_prior</code></a></li><li><a href="#ZeroNuFit.Likelihood.exp_stable"><code>ZeroNuFit.Likelihood.exp_stable</code></a></li><li><a href="#ZeroNuFit.Likelihood.gaussian_plus_lowEtail"><code>ZeroNuFit.Likelihood.gaussian_plus_lowEtail</code></a></li><li><a href="#ZeroNuFit.Likelihood.generate_data"><code>ZeroNuFit.Likelihood.generate_data</code></a></li><li><a href="#ZeroNuFit.Likelihood.get_bkg_pdf"><code>ZeroNuFit.Likelihood.get_bkg_pdf</code></a></li><li><a href="#ZeroNuFit.Likelihood.get_mu_b"><code>ZeroNuFit.Likelihood.get_mu_b</code></a></li><li><a href="#ZeroNuFit.Likelihood.get_mu_s"><code>ZeroNuFit.Likelihood.get_mu_s</code></a></li><li><a href="#ZeroNuFit.Likelihood.get_mu_s_b"><code>ZeroNuFit.Likelihood.get_mu_s_b</code></a></li><li><a href="#ZeroNuFit.Likelihood.get_signal_bkg_priors"><code>ZeroNuFit.Likelihood.get_signal_bkg_priors</code></a></li><li><a href="#ZeroNuFit.Likelihood.get_signal_pdf"><code>ZeroNuFit.Likelihood.get_signal_pdf</code></a></li><li><a href="#ZeroNuFit.Likelihood.get_signal_prior_info"><code>ZeroNuFit.Likelihood.get_signal_prior_info</code></a></li><li><a href="#ZeroNuFit.Likelihood.get_stat_blocks"><code>ZeroNuFit.Likelihood.get_stat_blocks</code></a></li><li><a href="#ZeroNuFit.Likelihood.norm_exponential"><code>ZeroNuFit.Likelihood.norm_exponential</code></a></li><li><a href="#ZeroNuFit.Likelihood.norm_linear"><code>ZeroNuFit.Likelihood.norm_linear</code></a></li><li><a href="#ZeroNuFit.Likelihood.norm_uniform"><code>ZeroNuFit.Likelihood.norm_uniform</code></a></li><li><a href="#ZeroNuFit.Likelihood.run_fit_over_partitions"><code>ZeroNuFit.Likelihood.run_fit_over_partitions</code></a></li><li><a href="#ZeroNuFit.Plotting.fit_model"><code>ZeroNuFit.Plotting.fit_model</code></a></li><li><a href="#ZeroNuFit.Plotting.plot_correlation_matrix"><code>ZeroNuFit.Plotting.plot_correlation_matrix</code></a></li><li><a href="#ZeroNuFit.Plotting.plot_data"><code>ZeroNuFit.Plotting.plot_data</code></a></li><li><a href="#ZeroNuFit.Plotting.plot_fit_and_data"><code>ZeroNuFit.Plotting.plot_fit_and_data</code></a></li><li><a href="#ZeroNuFit.Plotting.plot_marginal_distr"><code>ZeroNuFit.Plotting.plot_marginal_distr</code></a></li><li><a href="#ZeroNuFit.Plotting.plot_two_dim_posteriors"><code>ZeroNuFit.Plotting.plot_two_dim_posteriors</code></a></li><li><a href="#ZeroNuFit.Utils.check_key"><code>ZeroNuFit.Utils.check_key</code></a></li><li><a href="#ZeroNuFit.Utils.event_is_contained"><code>ZeroNuFit.Utils.event_is_contained</code></a></li><li><a href="#ZeroNuFit.Utils.generate_disjoint_uniform_samples"><code>ZeroNuFit.Utils.generate_disjoint_uniform_samples</code></a></li><li><a href="#ZeroNuFit.Utils.get_bkg_info"><code>ZeroNuFit.Utils.get_bkg_info</code></a></li><li><a href="#ZeroNuFit.Utils.get_corr_info"><code>ZeroNuFit.Utils.get_corr_info</code></a></li><li><a href="#ZeroNuFit.Utils.get_deltaE"><code>ZeroNuFit.Utils.get_deltaE</code></a></li><li><a href="#ZeroNuFit.Utils.get_efficiency"><code>ZeroNuFit.Utils.get_efficiency</code></a></li><li><a href="#ZeroNuFit.Utils.get_energy_scale_pars"><code>ZeroNuFit.Utils.get_energy_scale_pars</code></a></li><li><a href="#ZeroNuFit.Utils.get_events"><code>ZeroNuFit.Utils.get_events</code></a></li><li><a href="#ZeroNuFit.Utils.get_global_mode"><code>ZeroNuFit.Utils.get_global_mode</code></a></li><li><a href="#ZeroNuFit.Utils.get_marginalized_mode"><code>ZeroNuFit.Utils.get_marginalized_mode</code></a></li><li><a href="#ZeroNuFit.Utils.get_par_posterior"><code>ZeroNuFit.Utils.get_par_posterior</code></a></li><li><a href="#ZeroNuFit.Utils.get_partition_event_index"><code>ZeroNuFit.Utils.get_partition_event_index</code></a></li><li><a href="#ZeroNuFit.Utils.get_partitions"><code>ZeroNuFit.Utils.get_partitions</code></a></li><li><a href="#ZeroNuFit.Utils.get_partitions_events"><code>ZeroNuFit.Utils.get_partitions_events</code></a></li><li><a href="#ZeroNuFit.Utils.get_partitions_new"><code>ZeroNuFit.Utils.get_partitions_new</code></a></li><li><a href="#ZeroNuFit.Utils.get_range"><code>ZeroNuFit.Utils.get_range</code></a></li><li><a href="#ZeroNuFit.Utils.get_settings"><code>ZeroNuFit.Utils.get_settings</code></a></li><li><a href="#ZeroNuFit.Utils.inverse_uniform_cdf"><code>ZeroNuFit.Utils.inverse_uniform_cdf</code></a></li><li><a href="#ZeroNuFit.Utils.save_generated_samples"><code>ZeroNuFit.Utils.save_generated_samples</code></a></li><li><a href="#ZeroNuFit.Utils.save_results_into_json"><code>ZeroNuFit.Utils.save_results_into_json</code></a></li></ul><h3 id="analysis.jl"><a class="docs-heading-anchor" href="#analysis.jl">analysis.jl</a><a id="analysis.jl-1"></a><a class="docs-heading-anchor-permalink" href="#analysis.jl" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Analysis.retrieve_real_fit_results" href="#ZeroNuFit.Analysis.retrieve_real_fit_results"><code>ZeroNuFit.Analysis.retrieve_real_fit_results</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">retrieve_real_fit_results(config::Dict{String,Any})</code></pre><p>Function which handeles generating of fake data and run a signal+background model fit over it.</p><p><strong>Arguments</strong></p><ul><li><code>config::Dict{String,Any}</code>: the fit configuration.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/analysis.jl#L219-L226">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Analysis.run_analysis" href="#ZeroNuFit.Analysis.run_analysis"><code>ZeroNuFit.Analysis.run_analysis</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_analysis(config::Dict{String,Any}; output_path::String, toy_idx = nothing)</code></pre><p>Function which handeles running analysis.</p><p><strong>Arguments</strong></p><ul><li><code>config::Dict{String,Any}</code>: the fit configuration.</li><li><code>output_path::String</code>: the path to the output files folder.</li><li><code>toy_idx</code>: identification index of the generated toy.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/analysis.jl#L143-L152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Analysis.save_outputs" href="#ZeroNuFit.Analysis.save_outputs"><code>ZeroNuFit.Analysis.save_outputs</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_outputs(partitions, events, part_event_index, samples, posterior, nuisance_info, config, output_path, fit_ranges;priors=nothing,par_names=nothing,toy_idx=nothing)</code></pre><p>Function to plot and save results, as well as inputs.</p><p><strong>Arguments</strong></p><ul><li><code>partitions</code>: table of partitions.</li><li><code>events</code>: list of events (=energies) in each partition.</li><li><code>part_event_index</code>: index mapping events to the partitions.</li><li><code>samples</code>: set of generated MCMC samples.</li><li><code>posterior</code>: posterior distribution evaluated via <code>PosteriorMeasure(likelihood, prior)</code>.</li><li><code>nuisance_info</code>: dictionary with info on the prior parameters.</li><li><code>config</code>: input dictionary.</li><li><code>output_path</code>: output folder path.</li><li><code>fit_ranges</code>: dictionary of energy ranges considered for the analysis.</li><li><code>priors</code>: prior distributions.</li><li><code>par_names</code>: collection of parameter names.</li><li><code>toy_idx</code>: identification index of the generated toy.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/analysis.jl#L14-L32">source</a></section></article><h3 id="likelihood.jl"><a class="docs-heading-anchor" href="#likelihood.jl">likelihood.jl</a><a id="likelihood.jl-1"></a><a class="docs-heading-anchor-permalink" href="#likelihood.jl" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Likelihood.norm_uniform" href="#ZeroNuFit.Likelihood.norm_uniform"><code>ZeroNuFit.Likelihood.norm_uniform</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">norm_uniform(x::Real,p::NamedTuple,fit_range)</code></pre><p>Normalised flat function defined by 1/norm.</p><p><strong>Arguments</strong></p><ul><li><code>x::Real</code>: the x value to evaluate at.</li><li><code>p::NamedTuple</code>: collection of key-value pairs where each key corresponds to a model parameter.</li><li><code>fit_range</code>: array of arrays, defining the allowed energy ranges; e.g. <code>fit_range= [[1930,1950], [1970,1990], [2000,2050]]</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/likelihood.jl#L141-L150">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Likelihood.norm_linear" href="#ZeroNuFit.Likelihood.norm_linear"><code>ZeroNuFit.Likelihood.norm_linear</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">norm_linear(x::Float64,p::NamedTuple,b_name::Symbol,fit_range)</code></pre><p>Normalised linear function defined by (1+slope*(x-center)/net_width)/norm.</p><p><strong>Arguments</strong></p><ul><li><code>x::Real</code>: the x value to evaluate at.</li><li><code>p::NamedTuple</code>: collection of key-value pairs where each key corresponds to a model parameter.</li><li><code>b_name::Symbol</code>: name of the background index.</li><li><code>fit_range</code>: array of arrays, defining the allowed energy ranges; e.g. <code>fit_range= [[1930,1950], [1970,1990], [2000,2050]]</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/likelihood.jl#L160-L170">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Likelihood.norm_exponential" href="#ZeroNuFit.Likelihood.norm_exponential"><code>ZeroNuFit.Likelihood.norm_exponential</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">norm_exponential(x::Float64,p::NamedTuple,b_name::Symbol,fit_range)</code></pre><p>Normalised exponential function defined by exp_stable((x-center)*Rt)/norm.</p><p><strong>Arguments</strong></p><ul><li><code>x::Real</code>: the x value to evaluate at.</li><li><code>p::NamedTuple</code>: collection of key-value pairs where each key corresponds to a model parameter.</li><li><code>b_name::Symbol</code>: name of the background index.</li><li><code>fit_range</code>: array of arrays, defining the allowed energy ranges; e.g. <code>fit_range= [[1930,1950], [1970,1990], [2000,2050]]</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/likelihood.jl#L203-L213">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Likelihood.exp_stable" href="#ZeroNuFit.Likelihood.exp_stable"><code>ZeroNuFit.Likelihood.exp_stable</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">exp_stable(x::Float64)</code></pre><p>Exponential function, using Taylor expansion series for <code>abs(x) &lt; 1E-6</code>.</p><p><strong>Arguments</strong></p><ul><li><code>x::Real</code>: the x value to evaluate at.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/likelihood.jl#L186-L193">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Likelihood.gaussian_plus_lowEtail" href="#ZeroNuFit.Likelihood.gaussian_plus_lowEtail"><code>ZeroNuFit.Likelihood.gaussian_plus_lowEtail</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gaussian_plus_lowEtail(evt_energy::Float64,Qbb::Float64,bias::Float64,reso::Float64,part_k::NamedTuple)</code></pre><p>Signal model based on the peak shape used for the MJD analysis. The peak shape was derived from considerations made in [S. I. Alvis et al., Phys. Rev. C 100, 025501 (2019)].</p><p><strong>Arguments</strong></p><ul><li><code>evt_energy::Float64</code>: energy of the event at which we want to compute the function.</li><li><code>Qbb::Float64</code>: centroid of the Gaussian.</li><li><code>bias::Float64</code>: energy bias associated to the energy event.</li><li><code>reso::Float64</code>: energy resolution associated to the energy event.</li><li><code>part_k::NamedTuple</code>: Table of specifications for a given partition k.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/likelihood.jl#L238-L249">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Likelihood.get_mu_b" href="#ZeroNuFit.Likelihood.get_mu_b"><code>ZeroNuFit.Likelihood.get_mu_b</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_mu_b(deltaE, exposure, bkg_index)</code></pre><p>Get the expected number of background counts.</p><p><strong>Arguments</strong></p><ul><li><code>deltaE</code>: net width of the fit range.</li><li><code>exposure</code>: exposure (mass x time).</li><li><code>bkg_index</code>: background index value.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/likelihood.jl#L335-L344">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Likelihood.get_mu_s" href="#ZeroNuFit.Likelihood.get_mu_s"><code>ZeroNuFit.Likelihood.get_mu_s</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_mu_s(exposure, eff, signal)</code></pre><p>Get the expected number of signal counts.</p><p><strong>Arguments</strong></p><ul><li><code>exposure</code>: exposure (mass x time).</li><li><code>eff</code>: total signal efficiency.</li><li><code>signal</code>: number of signal counts</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/likelihood.jl#L349-L358">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Likelihood.get_mu_s_b" href="#ZeroNuFit.Likelihood.get_mu_s_b"><code>ZeroNuFit.Likelihood.get_mu_s_b</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_mu_s_b(p::NamedTuple,part_k::NamedTuple,idx_part_with_events::Int,settings::Dict,fit_range)</code></pre><p>Get the expected number of signal and background counts.</p><p><strong>Arguments</strong></p><ul><li><code>p::NamedTuple</code>: collection of key-value pairs where each key corresponds to a model parameter.</li><li><code>part_k::NamedTuple</code>: Table of specifications for a given partition k.</li><li><code>idx_part_with_events::Int</code>: index of the partition with the event.</li><li><code>settings::Dict</code>: dictionary of settings containing configuration for the likelihood calculation.</li><li><code>fit_range</code>: array of arrays, defining the allowed energy ranges; e.g. <code>fit_range= [[1930,1950], [1970,1990], [2000,2050]]</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/likelihood.jl#L367-L378">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Likelihood.build_likelihood_zero_obs_evts" href="#ZeroNuFit.Likelihood.build_likelihood_zero_obs_evts"><code>ZeroNuFit.Likelihood.build_likelihood_zero_obs_evts</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_likelihood_zero_obs_evts(part_k::NamedTuple, p::NamedTuple,settings::Dict,fit_range)</code></pre><p>Function to calculate the likelihood for a single data partition k with 0 events.</p><p><strong>Arguments</strong></p><ul><li><code>part_k::NamedTuple</code>: Table of specifications for a given partition k.</li><li><code>p::NamedTuple</code>: collection of key-value pairs where each key corresponds to a model parameter.</li><li><code>settings::Dict</code>: dictionary of settings containing configuration for the likelihood calculation.</li><li><code>fit_range</code>: array of arrays, defining the allowed energy ranges; e.g. <code>fit_range= [[1930,1950], [1970,1990], [2000,2050]]</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/likelihood.jl#L403-L413">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Likelihood.build_likelihood_per_partition" href="#ZeroNuFit.Likelihood.build_likelihood_per_partition"><code>ZeroNuFit.Likelihood.build_likelihood_per_partition</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_likelihood_per_partition(idx_part_with_events::Int,part_k::NamedTuple, events_k::Vector{Union{Float64}},p::NamedTuple,settings::Dict,bkg_shape::Symbol,fit_range)</code></pre><p>Function which computes the likelihood for a single data partition k.</p><p><strong>Arguments</strong></p><ul><li><code>idx_part_with_events::Int</code>: index of the partition with the event.</li><li><code>part_k::NamedTuple</code>: Table of specifications for a given partition k.</li><li><code>events_k::Vector{Union{Float64}}</code>: vecotr of events (=energies) in the partition k.</li><li><code>p::NamedTuple</code>: collection of key-value pairs where each key corresponds to a model parameter.</li><li><code>settings::Dict</code>: dictionary of settings containing configuration for the likelihood calculation.</li><li><code>bkg_shape::Symbol</code>: Specifies the background shape; default is <code>:uniform</code>.</li><li><code>fit_range</code>: array of arrays, defining the allowed energy ranges; e.g. <code>fit_range= [[1930,1950], [1970,1990], [2000,2050]]</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/likelihood.jl#L431-L444">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Likelihood.build_likelihood_looping_partitions" href="#ZeroNuFit.Likelihood.build_likelihood_looping_partitions"><code>ZeroNuFit.Likelihood.build_likelihood_looping_partitions</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_likelihood_looping_partitions(partitions::TypedTables.Table,events::Array{Vector{Float64}},part_event_index::Vector{Int},settings::Dict,sqrt_prior::Bool,s_max::Union{Float64,Nothing},fit_ranges;bkg_shape::Symbol=:uniform)</code></pre><p>Function to build the likelihood (a <code>DensityInterface.logfuncdensity</code> object) for the fit by looping over partitions.</p><p><strong>Arguments</strong></p><ul><li><code>partitions::TypedTables.Table</code>: table of partitions.</li><li><code>events::Array{Vector{Float64}}</code>: list of events (=energies) in each partition.</li><li><code>part_event_index::Vector{Int}</code>: index mapping events to the partitions.</li><li><code>settings::Dict</code>: A dictionary of settings containing configuration for the likelihood calculation.</li><li><code>sqrt_prior::Bool</code>: Whether to include the square root prior in the likelihood calculation. If <code>False</code>, a uniform prior is used.</li><li><code>s_max::Union{Float64, Nothing}</code>: A maximum value used for scaling the square root prior. If <code>Nothing</code>, no prior is applied.</li><li><code>fit_ranges</code>: The fitting ranges corresponding to the partitions.</li><li><code>bkg_shape::Symbol</code>: Specifies the background shape; default is <code>:uniform</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/likelihood.jl#L500-L514">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Likelihood.get_stat_blocks" href="#ZeroNuFit.Likelihood.get_stat_blocks"><code>ZeroNuFit.Likelihood.get_stat_blocks</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_stat_blocks(partitions,events::Array{Vector{Float64}},part_event_index,fit_ranges;config,bkg_only::Bool)</code></pre><p>Function to retrieve useful pieces (prior, likelihood, posterior), also in saving values.</p><p><strong>Arguments</strong></p><ul><li><code>partitions</code>: table of partitions.</li><li><code>events::Array{Vector{Float64}}</code>: list of events (=energies) in each partition.</li><li><code>part_event_index::Vector{Int}</code>: index mapping events to the partitions.</li><li><code>fit_ranges</code>: dictionary of energy ranges considered for the analysis.</li><li><code>config</code>: input dictionary.</li><li><code>bkg_only::Bool</code>: True if we are using a model with background only.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/likelihood.jl#L18-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Likelihood.run_fit_over_partitions" href="#ZeroNuFit.Likelihood.run_fit_over_partitions"><code>ZeroNuFit.Likelihood.run_fit_over_partitions</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_fit_over_partitions(partitions,events::Array{Vector{Float64}},part_event_index::Vector{Int}, config,fit_ranges)</code></pre><p>Function to run the fit looping over partitions.</p><p><strong>Arguments</strong></p><ul><li><code>partitions</code>: table of partitions.</li><li><code>events::Array{Vector{Float64}}</code>: list of events (=energies) in each partition.</li><li><code>part_event_index::Vector{Int}</code>: index mapping events to the partitions.</li><li><code>config</code>: input dictionary.</li><li><code>fit_ranges</code>: dictionary of energy ranges considered for the analysis.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/likelihood.jl#L80-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Likelihood.get_signal_prior_info" href="#ZeroNuFit.Likelihood.get_signal_prior_info"><code>ZeroNuFit.Likelihood.get_signal_prior_info</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_signal_prior_info(bkg_only::Bool,config)</code></pre><p>Function that retrieves signal prior information.</p><p><strong>Arguments</strong></p><ul><li><code>bkg_only::Bool</code>: True if we are using a model with background only.</li><li><code>config</code>: input dictionary.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/likelihood.jl#L119-L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Likelihood.get_signal_bkg_priors" href="#ZeroNuFit.Likelihood.get_signal_bkg_priors"><code>ZeroNuFit.Likelihood.get_signal_bkg_priors</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_signal_bkg_priors(config)</code></pre><p>Defines specific priors for signal and background contributions.</p><p><strong>Arguments</strong></p><ul><li><code>config</code>: input dictionary.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/likelihood.jl#L684-L691">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Likelihood.get_bkg_pdf" href="#ZeroNuFit.Likelihood.get_bkg_pdf"><code>ZeroNuFit.Likelihood.get_bkg_pdf</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_bkg_pdf(bkg_shape::Symbol,evt_energy::Float64,p::NamedTuple,b_name::Symbol,fit_range)</code></pre><p>Returns the background modeling function.</p><p><strong>Arguments</strong></p><ul><li><code>bkg_shape::Symbol</code>: Specifies the background shape; default is <code>:uniform</code>.</li><li><code>evt_energy::Float64</code>: energy of the event at which we want to compute the function.</li><li><code>p::NamedTuple</code>: collection of key-value pairs where each key corresponds to a model parameter.</li><li><code>b_name::Symbol</code>: name of the background index.</li><li><code>fit_range</code>: array of arrays, defining the allowed energy ranges; e.g. <code>fit_range= [[1930,1950], [1970,1990], [2000,2050]]</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/likelihood.jl#L275-L286">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Likelihood.get_signal_pdf" href="#ZeroNuFit.Likelihood.get_signal_pdf"><code>ZeroNuFit.Likelihood.get_signal_pdf</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_signal_pdf(evt_energy::Float64, Qbb::Float64, part_k::NamedTuple)</code></pre><p>Returns the signal modeling function.</p><p><strong>Arguments</strong></p><ul><li><code>evt_energy::Float64</code>: energy of the event at which we want to compute the function.</li><li><code>Qbb::Float64</code>: centroid of the Gaussian.</li><li><code>part_k::NamedTuple</code>: Table of specifications for a given partition k.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/likelihood.jl#L308-L317">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Likelihood.build_prior" href="#ZeroNuFit.Likelihood.build_prior"><code>ZeroNuFit.Likelihood.build_prior</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_prior(partitions,part_event_index,config,settings::Dict;hierachical=false,hierachical_mode=nothing,hierachical_range=nothing,bkg_shape=:uniform,shape_pars=nothing)</code></pre><p>Builds the priors for use in the fit.</p><p><strong>Arguments</strong></p><ul><li><code>partitions::Table</code>: Table of the partition info.</li><li><code>part_event_index::Vector{Int}</code>: index for the parameters for partitions with events.</li><li><code>config</code>: input dictionary.</li><li><code>settings::Dict</code>: A dictionary of settings containing configuration for the likelihood calculation.</li><li><code>hierachical</code>: True if we use a hierarchical model.</li><li><code>hierachical_mode</code>: average mode of the hierarchical model.</li><li><code>hierachical_range</code>: range of the reference distribution used to correlated the background indexes in a hierarchical model.</li><li><code>bkg_shape::Symbol</code>: Specifies the background shape; default is <code>:uniform</code>.</li><li><code>shape_pars</code>: background shape parameters, e.g. slope for linear or exponential background modeling.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/likelihood.jl#L717-L732">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Likelihood.generate_data" href="#ZeroNuFit.Likelihood.generate_data"><code>ZeroNuFit.Likelihood.generate_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_data(samples::BAT.DensitySampleVector,partitions::TypedTables.Table,part_event_index::Vector{Int},settings::Dict,fit_ranges;best_fit::Bool=false,seed=nothing,bkg_only=false)</code></pre><p>Generates data from a posterior distribution. This is based on the posterior predictive distributions.  Given a model with some parameters <code>theta_i</code>, the posterior predictive distribution, or the distribution of data generated according to the posterior distribution of theta and the likelihood is:</p><p class="math-container">\[p(y|D) =int p(y|theta)p(theta|D)dtheta\]</p><p>Or in terms of sampling we first draw samples of <code>theta</code> from the posterior and then generate, datasets based on the likelihood. We also give the options to fix the posterior distribution to the best fit, which is equivalent to the standard sampling methods.</p><p><strong>Arguments</strong></p><ul><li><code>samples::DensitySamplesVector</code>: samples of a past fit or a NamedTuple of best fit.</li><li><code>partitions::Table</code>: Table of the partition info.</li><li><code>part_event_index::Vector{Int}</code>: index for the parameters for partitions with events.</li><li><code>settings::Dict</code>: A dictionary of settings containing configuration for the likelihood calculation.</li><li><code>fit_ranges</code>: dictionary of energy ranges considered for the analysis.</li><li><code>best_fit::Bool</code>: True if you want to fix the paramaters to the best fit.</li><li><code>seed::Int</code>: random seed.</li><li><code>bkg_only::Bool</code>: True if we are using a model with background only.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/likelihood.jl#L566-L589">source</a></section></article><h3 id="plotting.jl"><a class="docs-heading-anchor" href="#plotting.jl">plotting.jl</a><a id="plotting.jl-1"></a><a class="docs-heading-anchor-permalink" href="#plotting.jl" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Plotting.plot_data" href="#ZeroNuFit.Plotting.plot_data"><code>ZeroNuFit.Plotting.plot_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_data(hist::Histogram,name,partitions,part_event_index,pars,samples,posterior,plotflag,settings::Dict,bkg_shape::Symbol,fit_ranges)</code></pre><p>Function to plot events in the Qbb analysis window and BAT fit results.</p><p><strong>Arguments</strong></p><ul><li><code>hist::Histogram</code>: binned histogram with energy events.</li><li><code>name</code>: title of the plot.</li><li><code>partitions</code>: table of partitions.</li><li><code>part_event_index</code>: index mapping events to the partitions.</li><li><code>pars</code>: free parameters in format (:B, :S, ...) </li><li><code>samples</code>: set of generated MCMC samples.</li><li><code>posterior</code>: posterior distribution evaluated via <code>PosteriorMeasure(likelihood, prior)</code>.</li><li><code>plotflag</code>: True if the 68% band is plotted together with the best fit result.</li><li><code>settings::Dict</code>: dictionary of settings containing configuration for the likelihood calculation.</li><li><code>bkg_shape::Symbol</code>: Specifies the background shape; default is <code>:uniform</code>.</li><li><code>fit_ranges</code>: The fitting ranges corresponding to the partitions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/plotting.jl#L88-L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Plotting.plot_fit_and_data" href="#ZeroNuFit.Plotting.plot_fit_and_data"><code>ZeroNuFit.Plotting.plot_fit_and_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_fit_and_data(partitions,part_event_index,samples,posterior,pars,output,config,fit_ranges;toy_idx=nothing)</code></pre><p>Retrieves event energies and calls <code>plot_data</code> to plot events in the Qbb analysis window and BAT fit results. </p><p><strong>Arguments</strong></p><ul><li><code>partitions</code>: table of partitions.</li><li><code>part_event_index</code>: index mapping events to the partitions.</li><li><code>samples</code>: set of generated MCMC samples.</li><li><code>posterior</code>: posterior distribution evaluated via <code>PosteriorMeasure(likelihood, prior)</code>.</li><li><code>pars</code>: free parameters in format (:B, :S, ...) </li><li><code>output</code>: output folder path.</li><li><code>config</code>: input dictionary.</li><li><code>fit_ranges</code>: The fitting ranges corresponding to the partitions.</li><li><code>toy_idx</code>: identification index of the generated toy.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/plotting.jl#L265-L280">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Plotting.plot_correlation_matrix" href="#ZeroNuFit.Plotting.plot_correlation_matrix"><code>ZeroNuFit.Plotting.plot_correlation_matrix</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_correlation_matrix(samples,output;par_names=nothing,toy_idx=nothing)</code></pre><p>Plots the correlation matrixes across the free parameters. </p><p><strong>Arguments</strong></p><ul><li><code>samples</code>: set of generated MCMC samples.</li><li><code>output</code>: output folder path.</li><li><code>par_names</code>: collection of parameter names.</li><li><code>toy_idx</code>: identification index of the generated toy.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/plotting.jl#L334-L344">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Plotting.plot_marginal_distr" href="#ZeroNuFit.Plotting.plot_marginal_distr"><code>ZeroNuFit.Plotting.plot_marginal_distr</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_marginal_distr(partitions,samples,pars,output;sqrt_prior=false,priors=nothing,par_names=nothing,plot_config=nothing,s_max=nothing,hier=false,toy_idx=nothing)</code></pre><p>Function to plot 1D and 2D marginalized posterior distributions, and prior distributions.</p><p><strong>Arguments</strong></p><ul><li><code>partitions</code>: table of partitions.</li><li><code>samples</code>: set of generated MCMC samples.</li><li><code>pars</code>: free parameters in format (:B, :S, ...) </li><li><code>output</code>: output folder path.</li><li><code>sqrt_prior</code>: True if a 1/sqrt(signal) prior distribution was used for the signal.</li><li><code>priors</code>: True if we want to overlap priors distributions over posterior distributions.</li><li><code>par_names</code>: collection of parameter names.</li><li><code>plot_config</code>: dictionary with plotting settings.</li><li><code>s_max</code>: maximum value of the marginalized signal posterior pdf.</li><li><code>hier</code>: True if we use a hierarchical model.</li><li><code>toy_idx</code>: identification index of the generated toy.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/plotting.jl#L427-L444">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Plotting.plot_two_dim_posteriors" href="#ZeroNuFit.Plotting.plot_two_dim_posteriors"><code>ZeroNuFit.Plotting.plot_two_dim_posteriors</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_two_dim_posteriors(samples,pars,output;par_names=nothing,toy_idx=nothing)</code></pre><p>Plots the correlation matrixes across the free parameters. </p><p><strong>Arguments</strong></p><ul><li><code>samples</code>: set of generated MCMC samples.</li><li><code>pars</code>: free parameters in format (:B, :S, ...) free parameters in format (:B, :S, ...) </li><li><code>output</code>: output folder path.</li><li><code>par_names</code>: collection of parameter names.</li><li><code>toy_idx</code>: identification index of the generated toy.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/plotting.jl#L365-L376">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Plotting.fit_model" href="#ZeroNuFit.Plotting.fit_model"><code>ZeroNuFit.Plotting.fit_model</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_model(idx_part_with_events::Int,part_k::NamedTuple,p::NamedTuple,settings::Dict,bkg_shape::Symbol,fit_range,x::Float64)</code></pre><p>Evaòuates the total modeling function at x.</p><p><strong>Arguments</strong></p><ul><li><code>idx_part_with_events::Int</code>: index of the partition with the event.</li><li><code>part_k::NamedTuple</code>: Table of specifications for a given partition k.</li><li><code>p::NamedTuple</code>: collection of key-value pairs where each key corresponds to a model parameter.</li><li><code>settings::Dict</code>: dictionary of settings containing configuration for the likelihood calculation.</li><li><code>bkg_shape::Symbol</code>: Specifies the background shape; default is <code>:uniform</code>.</li><li><code>fit_range</code>: array of arrays, defining the allowed energy ranges; e.g. <code>fit_range= [[1930,1950], [1970,1990], [2000,2050]]</code>.</li><li><code>x::Float64</code>: the x value to evaluate at.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/plotting.jl#L39-L52">source</a></section></article><h3 id="utils.jl"><a class="docs-heading-anchor" href="#utils.jl">utils.jl</a><a id="utils.jl-1"></a><a class="docs-heading-anchor-permalink" href="#utils.jl" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.check_key" href="#ZeroNuFit.Utils.check_key"><code>ZeroNuFit.Utils.check_key</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_key(config::Dict, k::String)</code></pre><p>Function that checks the existence of a key in a dictionary. If the key is not found, the code exits here.</p><p><strong>Arguments</strong></p><ul><li><code>config::Dict</code>: input dictionary.</li><li><code>k::String</code>: name of the key to check the existence of in <code>config</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L101-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.get_settings" href="#ZeroNuFit.Utils.get_settings"><code>ZeroNuFit.Utils.get_settings</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_settings(config::Dict{String,Any})</code></pre><p>Function that retrieves useful settings information from the input configuration dictionary.</p><p>Returns a dictionary containing information on energy bias/resolution/efficiency (if fixed or not, if correlated or not) and on the type of fit (if background only or not).</p><p><strong>Arguments</strong></p><ul><li><code>config::Dict{String,Any}</code>: input dictionary.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L119-L128">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.get_events" href="#ZeroNuFit.Utils.get_events"><code>ZeroNuFit.Utils.get_events</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_events(event_path::String,partitions)::Array{Vector{Float64}}</code></pre><p>Function that returns an Array of Vectors filled with energy events per each partition. The code exits here if an event can&#39;t be associated to any existing partition.</p><p><strong>Arguments</strong></p><ul><li><code>event_path::String</code>: path to the input JSON file with energy events.</li><li><code>partitions</code>: Table of retrieve partitions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L431-L440">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.event_is_contained" href="#ZeroNuFit.Utils.event_is_contained"><code>ZeroNuFit.Utils.event_is_contained</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">event_is_contained(event::Float64, fit_ranges)</code></pre><p>Function to check the containment of an energy event.</p><p>Returns true if the event is contained at least in one of the selected energy ranges.</p><p><strong>Arguments</strong></p><ul><li><code>event::Float64</code>: energy event.</li><li>fit<em>range<code>: array of arrays, defining the allowed energy ranges; e.g.</code>fit</em>range= [[1930,1950], [1970,1990], [2000,2050]]`</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L293-L303">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.get_partitions" href="#ZeroNuFit.Utils.get_partitions"><code>ZeroNuFit.Utils.get_partitions</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_partitions(config::Dict{String, Any})</code></pre><p>Function to retrieve a Table of partitions and a dictionary of fit ranges.</p><p><strong>Arguments</strong></p><ul><li><code>config::Dict{String,Any}</code>: input dictionary.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L398-L405">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.get_partitions_new" href="#ZeroNuFit.Utils.get_partitions_new"><code>ZeroNuFit.Utils.get_partitions_new</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_partitions_new(part_path::String)</code></pre><p>Get the partition information from a JSON file and save to a Table.</p><p>Returns a Table of partitions, a dictionary of fit groups, a dictionary of fit ranges.</p><p><strong>Arguments</strong></p><ul><li><code>part_path::String</code>: path to a given partition JSON file.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L150-L159">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.get_partitions_events" href="#ZeroNuFit.Utils.get_partitions_events"><code>ZeroNuFit.Utils.get_partitions_events</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_partitions_events(config::Dict{String, Any})</code></pre><p>Get partition, event, and fit range info from the configuration dictionary given in input.</p><p>Returns an object descirbing if a partition has an event by assigning indexes, an array of energy events, a Table of partitions, and fit ranges.</p><p><strong>Arguments</strong></p><ul><li><code>config::Dict{String,Any}</code>: input dictionary.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L315-L324">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.get_partition_event_index" href="#ZeroNuFit.Utils.get_partition_event_index"><code>ZeroNuFit.Utils.get_partition_event_index</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_partition_event_index(events::Array{Vector{Float64}},partitions::TypedTables.Table)::Vector{Int}</code></pre><p>Returns an object describing if a partition has an event and giving them indexes. This creates a vector where</p><ul><li><code>V[i]=0</code> if partition <code>i</code> has no events,</li><li><code>V[i]=idx</code> if partition <code>i</code> has events,</li></ul><p>where the index counts the number of partitions with <code>index&lt;=i</code>.</p><p><strong>Arguments</strong></p><ul><li><code>events::Array{Vector{Float64}}</code>: list of events (=energies) in each partition.</li><li><code>partitions::TypedTables.Table</code>: table of partitions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L364-L378">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.get_corr_info" href="#ZeroNuFit.Utils.get_corr_info"><code>ZeroNuFit.Utils.get_corr_info</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_corr_info(config)</code></pre><p>Function that retrieves information about correlated background from config in input.</p><p><strong>Arguments</strong></p><ul><li><code>config</code>: input dictionary.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L23-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.get_energy_scale_pars" href="#ZeroNuFit.Utils.get_energy_scale_pars"><code>ZeroNuFit.Utils.get_energy_scale_pars</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_energy_scale_pars(part_k::NamedTuple,p::NamedTuple,settings::Dict,idx_part_with_events)</code></pre><p>Returns the energy resolution and bias for a given partition, depending on the specified settings (e.g. if correlated or not, if fixed or not).</p><p><strong>Arguments</strong></p><ul><li><code>p::NamedTuple</code>: collection of key-value pairs where each key corresponds to a model parameter.</li><li><code>part_k::NamedTuple</code>: Table of specifications for a given partition k.</li><li><code>settings::Dict</code>: a dictionary containing information on energy bias/resolution/efficiency (if fixed or not, if correlated or not) and on the type of fit (if background only or not).</li><li><code>idx_part_with_events::Int</code>: index of the partition with the event.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L526-L537">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.get_efficiency" href="#ZeroNuFit.Utils.get_efficiency"><code>ZeroNuFit.Utils.get_efficiency</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_efficiency(p::NamedTuple,part_k::NamedTuple,idx_part_with_events::Int,settings::Dict)</code></pre><p>Returns the efficiency for a given partition, depending on the specified settings (e.g. if correlated or not, if fixed or not). If you are fitting with a background-only model, then efficiency=0.</p><p><strong>Arguments</strong></p><ul><li><code>p::NamedTuple</code>: collection of key-value pairs where each key corresponds to a model parameter.</li><li><code>part_k::NamedTuple</code>: Table of specifications for a given partition k.</li><li><code>idx_part_with_events::Int</code>: index of the partition with the event.</li><li><code>settings::Dict</code>: a dictionary containing information on energy bias/resolution/efficiency (if fixed or not, if correlated or not) and on the type of fit (if background only or not).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L478-L489">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.get_deltaE" href="#ZeroNuFit.Utils.get_deltaE"><code>ZeroNuFit.Utils.get_deltaE</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_deltaE(fit_range)</code></pre><p>Function that returns the net width of the fit range.</p><p><strong>Arguments</strong></p><ul><li><code>fit_range</code>: array of arrays, defining the allowed energy ranges; e.g. <code>fit_range= [[1930,1950], [1970,1990], [2000,2050]]</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L814-L821">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.get_range" href="#ZeroNuFit.Utils.get_range"><code>ZeroNuFit.Utils.get_range</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_range(fit_range)</code></pre><p>Function that returns lower and upper edges of fit ranges.</p><p><strong>Arguments</strong></p><ul><li><code>fit_range</code>: array of arrays, defining the allowed energy ranges; e.g. <code>fit_range= [[1930,1950], [1970,1990], [2000,2050]]</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L827-L834">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.get_bkg_info" href="#ZeroNuFit.Utils.get_bkg_info"><code>ZeroNuFit.Utils.get_bkg_info</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_bkg_info(config)</code></pre><p>Function that retrieves background shape name and parameters (if different from flat) from the input configuration dictionary.</p><p><strong>Arguments</strong></p><ul><li><code>config</code>: input dictionary.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L78-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.get_global_mode" href="#ZeroNuFit.Utils.get_global_mode"><code>ZeroNuFit.Utils.get_global_mode</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_global_mode(samples, posterior)</code></pre><p>Function which retrieves global mode and a refined estimate of it (using <code>bat_findmode</code>).</p><p><strong>Arguments</strong></p><ul><li><code>samples</code>: set of generated MCMC samples.</li><li><code>posterior</code>: posterior distribution evaluated via <code>PosteriorMeasure(likelihood, prior)</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L651-L659">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.get_marginalized_mode" href="#ZeroNuFit.Utils.get_marginalized_mode"><code>ZeroNuFit.Utils.get_marginalized_mode</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_marginalized_mode(samples, par)</code></pre><p>Function which retrieves marginalized mode as the highest bin of the posterior, using 250 bins (vs 100 bins set by default by BAT).</p><p><strong>Arguments</strong></p><ul><li><code>samples</code>: set of generated MCMC samples.</li><li><code>par</code>: name of the parameter for which we want to extract the marginalized mode.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L670-L678">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.get_par_posterior" href="#ZeroNuFit.Utils.get_par_posterior"><code>ZeroNuFit.Utils.get_par_posterior</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_par_posterior(samples, par; idx)</code></pre><p>Function that retrieves the parameter posterior.</p><p><strong>Arguments</strong></p><ul><li><code>samples</code>: set of generated MCMC samples.</li><li><code>par</code>: name of the parameter for which we want to extract the marginalized mode.</li><li><code>idx</code>: index for multiparameters</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L48-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.inverse_uniform_cdf" href="#ZeroNuFit.Utils.inverse_uniform_cdf"><code>ZeroNuFit.Utils.inverse_uniform_cdf</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">inverse_uniform_cdf(p, fit_range)</code></pre><p>Returns the inverse cumulative distribution function value for the given probability <code>p</code>.</p><p><strong>Arguments</strong></p><ul><li><code>p</code>: probability between 0 and 1 representing the desired quantile of the cumulative distribution.</li><li><code>fit_range</code>: array of arrays, defining the allowed energy ranges; e.g. <code>fit_range= [[1930,1950], [1970,1990], [2000,2050]]</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L573-L582">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.generate_disjoint_uniform_samples" href="#ZeroNuFit.Utils.generate_disjoint_uniform_samples"><code>ZeroNuFit.Utils.generate_disjoint_uniform_samples</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_disjoint_uniform_samples(n, fit_range; seed = nothing)</code></pre><p>Generates a list of <code>n</code> events uniform sampled within a specified range using the inverse CDF method.</p><p><strong>Arguments</strong></p><ul><li><code>n</code>: number of events to randomly generate.</li><li><code>fit_range</code>: array of arrays, defining the allowed energy ranges; e.g. <code>fit_range= [[1930,1950], [1970,1990], [2000,2050]]</code>.</li><li><code>seed</code>: fix to a value if you want to fix the random generator seed.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L615-L625">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.save_generated_samples" href="#ZeroNuFit.Utils.save_generated_samples"><code>ZeroNuFit.Utils.save_generated_samples</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_generated_samples(samples,output)</code></pre><p>Saves generated MCMC samples to <code>.jld2</code> and <code>.h5</code> files.</p><p><strong>Arguments</strong></p><ul><li><code>samples</code>: set of generated MCMC samples.</li><li><code>output</code>: output folder path.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L636-L644">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZeroNuFit.Utils.save_results_into_json" href="#ZeroNuFit.Utils.save_results_into_json"><code>ZeroNuFit.Utils.save_results_into_json</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_results_into_json(samples,posterior,nuisance_info,config,output;par_names=nothing,toy_idx=nothing)</code></pre><p>Function which saves results from the fit and the used input configurations.</p><p><strong>Arguments</strong></p><ul><li><code>samples</code>: set of generated MCMC samples.</li><li><code>posterior</code>: posterior distribution evaluated via <code>PosteriorMeasure(likelihood, prior)</code>.</li><li><code>nuisance_info</code>: dictionary with info on the prior parameters.</li><li><code>config</code>: input dictionary.</li><li><code>output</code>: output folder path.</li><li><code>par_names</code>: collection of parameter names.</li><li><code>toy_idx</code>: identification index of the generated toy.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/ZeroNuFit.jl/blob/f844b5acb924272fe362a2917b0e42f2c4fdbae8/src/utils.jl#L693-L706">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial/">« Tutorial</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Friday 14 February 2025 17:53">Friday 14 February 2025</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
